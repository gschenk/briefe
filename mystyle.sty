\NeedsTeXFormat{LaTeX2e} 
\ProvidesPackage{mystyle}[2016/11/01 defines some layout choices for sclttr2]

\RequirePackage{ifthen}

\newif\ifgerman

\DeclareOption{english}{%
  \germanfalse
  \PassOptionsToPackage{english}{babel}
}

\DeclareOption{german}{%
  \germantrue
  \PassOptionsToPackage{german}{babel}
}

\ProcessOptions

%% class options scrlttr2 options
\LoadLetterOptions{DINmtext} %mtext}

% hyphenation patterns
\RequirePackage{babel}

% microtype for better typesetting
\RequirePackage{microtype}

% libertine font family (biolinum sf)
\RequirePackage{libertine}
\RequirePackage{libertinust1math}


% sans serif subject and title
\setkomafont{subject}{\sffamily\bfseries}
\setkomafont{title}{\sffamily\scshape}

% iso date format
% finer control of date format
\ifgerman
  \PassOptionsToPackage{german}{isodate}
\else
  \PassOptionsToPackage{english}{isodate}
\fi

\RequirePackage{isodate}
\isodate


%% recipient address line
%  takes handle from .adr file \addrentry #9
%  entry as argument
\RequirePackage{scraddr}
\newcommand{\AutoRecipientAddress}[1]{%
  \ifgerman
    \if m\FreeI{#1}
      {Herrn \\}
    \fi
    \if f\FreeI{#1}
      {Frau \\}
    \fi
    \FreeIII{#1}%
  \fi
  \FirstName{#1}
  \LastName{#1}
  \\
  \FreeIV{#1}
  \Address{#1}
}

%% opening, salutation
\newcommand{\AutoOpening}[1]{}
\ifgerman
  \providecommand{\fSal}{Sehr geehrte Frau }
  \providecommand{\mSal}{Sehr geehrter Herr }
  \providecommand{\genSal}{Sehr geehrte Damen und Herren,}
\else
  \providecommand{\fSal}{Dear Ms}
  \providecommand{\mSal}{Dear Mr}
  \providecommand{\genSal}{To whom it may concern}
\fi

\providecommand{\SalutationName}[1]{%
  \ifgerman % no point after abbr in UK english
    \FreeII{#1}%academic degrees Dr and Prof
  \fi
  \LastName{#1}%
  \ifgerman % no comma in modern english
    ,
  \fi
}
\renewcommand{\AutoOpening}[1]{%
  % check for the correct case,
  % that can be stored in the first
  % free argument of \addrentry (ie #5)
  \if f\FreeI{#1}%
    \fSal
  \else \if m\FreeI{#1}%
      \mSal
    \else
      \genSal
      \renewcommand{\SalutationName}[1]{}
    \fi
  \fi
  \SalutationName{#1}
}


% vim: set ai ft=tex expandtab shiftwidth=2 softtabstop=2 fdm=marker spelllang=en_uk spell:

